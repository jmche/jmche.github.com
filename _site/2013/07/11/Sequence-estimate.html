<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Jingmin" />
    <title>测序量估计 | Jingmin</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/feed/" rel="alternate" title="Jingmin" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css">
    <link rel="stylesheet" href="/media/css/highlight.css">
    <link rel="stylesheet" href="/media/css/backtop.css">                 
    <script type="text/javascript" src="/media/js/backtop.js"></script>   
    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>

  </head>

  <script type="text/javascript">
    function setTimeSpan(){
    	var date = new Date();
    	timeSpan.innerText=date.format('yyyy-MM-dd hh:mm:ss');
    }
    
    Date.prototype.format = function(format)
		{
    var o =
    	{
    	    "M+" : this.getMonth()+1, //month
    	    "d+" : this.getDate(),    //day
    	    "h+" : this.getHours(),   //hour
    	    "m+" : this.getMinutes(), //minute
    	    "s+" : this.getSeconds(), //second
    	    "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
    	    "S" : this.getMilliseconds() //millisecond
    	}
    	if(/(y+)/.test(format))
    	format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
    	for(var k in o)
    	if(new RegExp("("+ k +")").test(format))
    	format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
    	return format;
		}
  </script>

  <body onLoad="setInterval(setTimeSpan,1000);">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>测序量估计</h1>
        </header>
        <nav>
        <span><a title="about" class="" href="/">About</a></span>
	<span><a title="resume" class="" href="/resume/">Resume</a></span>
	<span><a title="blog" class="" href="/blog/">Blog</a></span>
        <span><a title="guestbook" class="" href="/guestbook/">Guestbook</a></span>
        <span><a title="categories" class="" href="/categories/">Categories</a></span>
        <span><a title="tags" class="" href="/tags/">Tags</a></span>
        <!-- <span><a title="links" class="" href="/links/">Links</a></span> -->
        <!-- <span><a title="subscribe by feed" class="" href="/feed/">Subscribe</a></span> -->
        </nav>
        <article class="content">
        <span class="time">
  <time datetime="2013-07-11">2013-07-11</time>
</span>


<span class="author">
  /
  <a href="">Jingmin</a>
</span>


<span class="tags">
  /
  
  <a href="/tags/#NGS" title="NGS">#NGS</a>
  
  <a href="/tags/#测序技术" title="测序技术">#测序技术</a>
  
  <a href="/tags/#估计" title="估计">#估计</a>
  
</span>


<!-- 开头提示文章末尾有二维码 -->

<section class="post">
<p>From: <a href="http://www.stbioinf.com/2013/07/11/Sequence-estimate.html">http://www.stbioinf.com</a></p>
<p>　　考虑这样一个问题，&ldquo;如果要保证基因组上95%的区域其覆盖深度在30x以上的话，那么最低的平均测序深度应该是多少？&rdquo;。</p>
<p>　　关于测序量的估计，对于做生物信息的人来讲应算是家常便饭了，多数时候我们都能直接根据以往项目的经验来获得，或是说的更具体些，在变异检测中一般要有25x以上的覆盖度才能得到一个比较靠谱的结果，于是以此为目的给出测序量的估计值；当然少数情况下也会有直接拍脑袋拍出一个值来的疯狂行为，不过嘛，虽说是拍脑袋，但也不是随便拍的，拍脑袋的背景靠的是身后丰富的经验。相对更好一些的估计方式就是直接模拟数据，不过总是用模拟数据还是让人觉得麻烦，最好是能不用花多少时间，也不用做很多的计算就能脱口给出。我想在这里说一下这种情况下我的解法。当然了并不一定完全准确，仅作交流，欢迎各位拍砖。</p>
<p>　　闲话说完，回到上面的问题，在不通过数据模拟也不&ldquo;拍脑袋&rdquo;的情况下，要如何才能估算出一个合理的值呢？其实在作出任何推断之前我们都应当要先有一个合理的前提假设，或者说是理论依据来作为后续分析的基础。我们都知道短序列测序的一个特点是，在理论情况下位点被覆盖到的深度符合泊松分布（测序没什么问题的话，实际的情形也相差不多），但实际上在这种情况下用正态分布来考虑也是合理的，作为一个估计值，误差也是能够接受的，这是我们的基础。之所以想用正态分布来考虑，是因为正态分布有许多方便于计算的性质。其中一个很有用的法则，就是&ldquo;68-95-99&rdquo;法则，意思就是距离均值一个标准差的区域围起来的面积大约是总体的68%，2个标准差的区域范围的面积是总体的95%，3个标准差区域范围占到了总体的99%，如果你自己想要验证这一法则也并不困难，只需做些积分就能算出来，但这里就不做计算了。如下图，均值用&mu;表示，标准差用&sigma;表示。</p>
<p><img src="http://upload.wikimedia.org/wikipedia/commons/8/8c/Standard_deviation_diagram.svg" alt="Normal distribution" /></p>
<p>　　现在事情就很简单了，从图中我们可以看出，只要30x深度的位置在-2&sigma;以下，那么就能达到理论的要求。要得到这一结果，问题就只剩下一个了，此时我们只需要知道测序深度分布的标准差就能粗略估计出此时我们所需要的最低平均测序深度。虽然这个标准差跟许多因素有关，这里以illumina公司的Hiseq系列测序仪为例子，依照以往基因组重测序的经验，&sigma;约等于10x。那么，简单算一下，此刻，理论上我们只需要测50x就可以使得基因组上有97.7%的区域其覆盖深度在30x以上了，注意这里不是95%了，因为我们的区域实际上是[-2&sigma;, +&infin;)，而不是[-2&sigma;,+2&sigma;]! 再除掉一些边边角角的误差，50x这个值在这里应当是合理的了。</p>
<p>　　以上计算都是以正态分布为基础而做出的估计。当然了，如果一定要用泊松分布去推算也可以，只是运算起来会麻烦很多。此外，如果是不同系列或是不同公司的测序仪，&sigma;就不一定是10了。</p>
<p>&nbsp;</p>

</section>

<section class="meta">

<br/>

<span>
	<a   class="pageNavInvalid"  >Previous</a>

	&nbsp;&nbsp;&nbsp;

	<a  href="/2013/08/02/An-Introduction-of-NGS-Sequence.html" class="pageNav"  >Next</a>
  
</span>
<hr>
<span class="author">
  <a href="">Jingmin</a>
</span>
<span class="time">
  /
  <time datetime="2013-07-11">2013-07-11</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>


<span class="categories">
  in categories
  
  <a href="/categories/#生物信息" title="生物信息">生物信息</a>&nbsp;
  
</span>



<span class="tags">
  tagged with 
  
  <a href="/tags/#NGS" title="NGS">NGS</a>&nbsp;
  
  <a href="/tags/#测序技术" title="测序技术">测序技术</a>&nbsp;
  
  <a href="/tags/#估计" title="估计">估计</a>&nbsp;
  
</span>


</section>

<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jmche'; // required: replace example with your forum shortname
    // var disqus_url = '/2013/07/11/Sequence-estimate.html';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




<!-- Baidu Botton (Part 2/2) -->
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!-- Baidu Botton End -->


        </article>
      </div>

      <footer>
		

        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> & <a href="http://pages.github.com">GitHub</a> | Copyright &copy; 2013 ~ 2014 by <a href="/about/">Jingmin</a></small></p>
      </footer>
    </div>


    <div id="back-top">
        <a href="#top" title="Top"></a>
    </div>
  </body>
</html>
